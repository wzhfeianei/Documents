# 环境预估及分配

## 现状

现有云商环境因进货市场与之前公司其它项目宇商及 SD 之前调用比如繁杂 , 例如在调用
SD 测试环境的数据库时 , 因 SD 的测试库包括全国 33 个省的子库 ( 其实我也太了解明
白这 33 个子库有啥用 , 可能架构较早了 ), 库较多的直接后果就是对方测试人员不愿意
维护多一套测试库 , 所以之前开发测试共用一套测试环境 .

## 目的

共用一套测试环境的直接后果就是开发人员不停的调试与测试人员环境使用之间的剧烈冲突
, 严重影响项目开发进度 ; 并且现有测试环境的服务器架构与生产也不相同 , 导致问题多
多 , 刚到项目组就被领导拉来要梳理出一套测试 , 独立与开发环境 , 并且要做到持续集
成 .

## 环境分析

### 生产环境现有部署情况

生产环境现在架构情况大致如下 :

在现在环境发包时主要变化有 6 个包 , 分别为

1. smp-eaec-`war 包`
2. smp-web-`war 包`
3. smp-sms-`jar 包`
4. smp-order-`jar 包`
5. smp-outside-`jar 包`
6. smp-cart-`jar 包`

其它还有一部分是共同服务如`redis`、`zookeeper`、`MQ`等 , 也有公司其它服务的调用
, 这些一般不发包或是由其它部分负责 .

### 之前共用测试环境现有部署情况

之前测试环境整体与生产环境类似的架构及部署 , 不同的地方在于`smp-eaec`应用是部署
在`Windows`系统`Weblogic`上的 , 而生产环境则是部署在`Linux`上的 .

### 新测试环境与之前共用环境的部署

根据环境整体情况与人力安排 , 新的独立测试环境主要对相关的 6 个包进行构建与持续集
成 , 缓存及 MQ 和数据均使用相同的一套环境 .

## 环境路径检查

经检查之前共用环境与生产环境下的项目部署的路径情况

### 快速检查

检查当前运行程序 , 后根据其 PID 查看

```shell
ps -ef |grep java

ll /proc/PID
```

对比后发现 , 生产环境与之前共用环境的部署也都不到一致 , 为达到后续统一化 , 新的
测试环境的部署路径需要与生产一致 , 但生产环境的部署也有点太随意化了 , 有部署应用
还是考虑到整体的统一 , 均部署到`/opt/pruduct/projectName`内 ,`projectName`为项目
名。
